# Art Design Pro 工程规范

## 📋 概述

Art Design Pro 采用完整的工程化规范体系，通过多种工具的配合使用，确保代码质量、提升开发效率，并规范团队协作流程。

## 🔧 规范体系

### 代码提交校验与格式化

使用 **ESLint**、**Prettier**、**Stylelint** 等工具，配合 **Husky**、**Lint-staged**，实现代码提交时的自动校验与格式化，规范团队开发流程。

### 代码提交规范化

使用 **CommitLint**、**cz-git** 等工具，规范 Git 提交信息，提升项目的可维护性和协作效率。

## ⚙️ 自动化配置

代码提交会自动执行配置好的文件，自动完成代码校验和格式化。位于 `package.json` 中配置：

```json
"lint-staged": {
  "*.{js,ts}": [
    "eslint --fix",
    "prettier --write"
  ],
  "*.{cjs,json}": [
    "prettier --write"
  ],
  "*.{vue,html}": [
    "eslint --fix",
    "prettier --write",
    "stylelint --fix"
  ],
  "*.{scss,css}": [
    "stylelint --fix",
    "prettier --write"
  ],
  "*.md": [
    "prettier --write"
  ]
}
```

## 🛠️ 工具介绍

| 工具 | 作用 | 说明 |
|------|------|------|
| **ESLint** | JavaScript 代码检查 | 检查代码语法错误和代码规范 |
| **Prettier** | 代码格式化 | 统一代码风格和格式 |
| **Stylelint** | CSS 代码检查 | 检查和规范 CSS/SCSS 代码 |
| **CommitLint** | Git 提交信息检查 | 验证提交信息格式 |
| **Husky** | Git 钩子工具 | 在 Git 操作时触发自动化脚本 |
| **Lint-staged** | 暂存文件检查 | 仅对暂存的文件运行代码校验 |
| **cz-git** | 可视化提交工具 | 提供交互式的规范化提交界面 |

## 📝 可用命令

### 代码检查与修复

#### 语法检查
```bash
# 检查项目中的 JavaScript/TypeScript 语法
pnpm lint
```

#### 自动修复
```bash
# 修复项目中 JavaScript/TypeScript 语法错误
pnpm fix
```

### 代码格式化

#### Prettier 格式化
```bash
# 使用 Prettier 格式化所有指定类型的文件
pnpm lint:prettier
```

#### Stylelint 检查
```bash
# 使用 Stylelint 检查和自动修复 CSS、SCSS 和 Vue 文件中的样式问题
pnpm lint:stylelint
```

### Git 相关

#### 暂存文件检查
```bash
# 运行 lint-staged 仅检查暂存的文件，确保提交前代码质量
pnpm lint:lint-staged
```

#### 设置 Git 钩子
```bash
# 设置 Husky Git 钩子，用于在 Git 操作前运行脚本
pnpm prepare
```

#### 规范化提交
```bash
# 使用 Commitizen 规范化提交消息，确保提交格式一致
pnpm commit
```

## 📋 提交规范

### 提交类型 (Type)

| 类型 | 说明 |
|------|------|
| `feat` | 新增功能 |
| `fix` | 修复缺陷 |
| `docs` | 文档变更 |
| `style` | 代码格式（不影响功能，例如空格、分号等格式修正） |
| `refactor` | 代码重构（不包括 bug 修复、功能新增） |
| `perf` | 性能优化 |
| `test` | 添加疏漏测试或已有测试改动 |
| `build` | 构建流程、外部依赖变更（如升级 npm 包、修改 webpack 配置等） |
| `ci` | 修改 CI 配置、脚本 |
| `revert` | 回滚 commit |
| `chore` | 对构建过程或辅助工具和库的更改（不影响源文件、测试用例） |
| `wip` | 进行中的工作（work in progress） |

### 提交信息格式

```
<type>(<scope>): <subject>

<body>

<footer>
```

#### 示例

```
feat(user): 添加用户登录功能

- 实现用户名密码登录
- 添加记住密码功能
- 集成第三方登录

Closes #123
```

## 🚀 完整提交流程

### 1. 添加文件到暂存区
```bash
git add .
```

### 2. 规范化提交
```bash
pnpm commit
```
执行后会出现交互式界面，按提示选择：
- **提交类型**：选择合适的 type（feat、fix、docs 等）
- **影响范围**：选择或输入 scope（可选）
- **简短描述**：输入 subject
- **详细描述**：输入 body（可选）
- **是否包含破坏性变更**：选择是否有 breaking changes
- **关联的 issue**：输入相关的 issue 编号（可选）

### 3. 推送到远程仓库
```bash
git push
```

## 🔍 自动化执行流程

### Pre-commit 钩子

当执行 `git commit` 时，Husky 会自动触发以下流程：

1. **Lint-staged** 检查暂存的文件
2. **ESLint** 检查 JavaScript/TypeScript 代码
3. **Prettier** 格式化代码
4. **Stylelint** 检查和修复样式代码
5. **CommitLint** 验证提交信息格式

### 文件类型处理

- **JavaScript/TypeScript 文件** (*.js, *.ts)
  - ESLint 检查和修复
  - Prettier 格式化

- **配置文件** (*.cjs, *.json)
  - Prettier 格式化

- **Vue/HTML 文件** (*.vue, *.html)
  - ESLint 检查和修复
  - Prettier 格式化
  - Stylelint 样式检查和修复

- **样式文件** (*.scss, *.css)
  - Stylelint 检查和修复
  - Prettier 格式化

- **Markdown 文件** (*.md)
  - Prettier 格式化

## 💡 最佳实践

### 开发建议

1. **提交前检查**：养成使用 `pnpm lint` 检查代码的习惯
2. **频繁提交**：保持小而频繁的提交，每个提交只做一件事
3. **清晰描述**：提交信息要清晰描述所做的更改
4. **遵循规范**：严格按照提交规范格式编写提交信息

### 团队协作

1. **统一工具版本**：确保团队成员使用相同版本的工具
2. **定期更新规范**：根据项目需要及时更新代码规范
3. **代码审查**：结合 Git 流程进行代码审查
4. **持续改进**：根据团队反馈不断优化工程规范

## ⚠️ 注意事项

1. **首次使用**：项目克隆后需要运行 `pnpm prepare` 安装 Git 钩子
2. **工具冲突**：避免编辑器插件与项目配置冲突
3. **规范一致性**：所有团队成员必须遵循相同的代码规范
4. **异常处理**：如果自动化工具出现问题，可以使用 `git commit --no-verify` 跳过检查（不推荐）

通过这套完整的工程规范体系，可以确保项目代码质量，提升团队协作效率，并维护代码库的长期可维护性。
