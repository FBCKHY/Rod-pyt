# 产品模板系统测试指南

## ✅ 已完成的功能

### 后端功能

1. ✅ **产品ID自动生成**
   - 文件: `backend/src/services/productService.js`
   - 函数: `generateProductId()`
   - 格式: `RD-001`, `RD-002`, `RD-003`...
   - 逻辑: 查找最大序号 + 1

2. ✅ **文件夹自动重命名**
   - 文件: `backend/src/services/productService.js`
   - 函数: `uploadProductFiles()`
   - 逻辑: 使用 `product.model` 作为文件夹名
   - 路径: `public/products/RD-001/`

3. ✅ **产品创建API**
   - 路由: `POST /api/products`
   - 功能: 自动生成model字段
   - 返回: 包含生成的产品ID

4. ✅ **文件上传API**
   - 路由: `POST /api/products/:id/files`
   - 功能: 上传文件夹并重命名
   - 校验: 文件夹结构验证

### 前端功能

1. ✅ **产品向导组件**
   - 文件: `admin/src/views/product/list/components/ProductWizard.vue`
   - 修改: 产品型号字段改为只读
   - 显示: 自动生成提示

2. ✅ **产品加载器**
   - 文件: `web Site/web PC/js/product-loader.js`
   - 功能: 从API动态加载产品
   - 支持: 多种展示位置

3. ✅ **分类加载器**
   - 文件: `web Site/web PC/js/category-loader.js`
   - 功能: 从API动态加载分类
   - 支持: 分类筛选、切换

### 文档

1. ✅ **实现方案文档**
   - 文件: `产品详情模板系统实现方案.md`
   - 内容: 完整的技术实现方案

2. ✅ **使用指南**
   - 文件: `产品详情模板系统使用指南.md`
   - 内容: 详细的使用说明

---

## 🧪 测试步骤

### 1. 测试后端API

#### 测试产品创建(自动生成ID)

```powershell
# 创建产品(不传model字段)
curl -X POST http://localhost:3001/api/products `
  -H "Content-Type: application/json" `
  -d '{
    "name": "测试产品1",
    "price": 999.00,
    "categoryId": 1,
    "status": "active"
  }'

# 预期返回:
# {
#   "code": 200,
#   "data": {
#     "id": 1,
#     "name": "测试产品1",
#     "model": "RD-001",  <-- 自动生成
#     "price": 999.00,
#     ...
#   }
# }
```

#### 测试文件夹上传

```powershell
# 准备测试文件夹
# 结构: RD-001/产品详情.html, RD-001/图片/, RD-001/样式逻辑/

# 使用Postman或类似工具上传
POST http://localhost:3001/api/products/1/files
Content-Type: multipart/form-data

files: [选择多个文件]
relativePaths[]: RD-001/产品详情.html
relativePaths[]: RD-001/图片/图1.jpg
relativePaths[]: RD-001/样式逻辑/产品详情.css
relativePaths[]: RD-001/样式逻辑/产品详情.js

# 预期结果:
# - 文件夹保存到 public/products/RD-001/
# - 产品的filePath字段更新为 products/RD-001
```

### 2. 测试后台管理系统

#### 测试产品创建向导

1. 访问: http://localhost:3006
2. 登录系统
3. 进入: 产品管理 → 产品列表
4. 点击: 新增产品
5. 检查:
   - ✅ 产品型号字段显示为只读
   - ✅ 显示提示: "系统将自动生成 (如: RD-001)"
   - ✅ 有钥匙图标

#### 测试产品创建流程

**步骤1: 制作产品卡片**
- 填写产品名称: `测试产品A`
- 产品型号: 留空(自动生成)
- 产品价格: `1999.00`
- 上传卡片主图
- 选择标签: `热销`
- 添加特性: `高品质`, `节能环保`
- 销售数量: `100`
- 点击: 下一步

**步骤2: 上传详情页文件**
- 准备文件夹(参考 `产品详情页面模版/RD-001`)
- 拖拽文件夹到上传区域
- 检查校验结果:
  - ✅ 根目录 HTML 文件 (1个)
  - ✅ 样式逻辑/ 内 CSS (1个)
  - ✅ 样式逻辑/ 内 JS (1个)
  - ✅ 图片/ 子文件夹
- 点击: 下一步

**步骤3: 配置产品信息**
- 选择分类: `燃气灶系列`
- 推广位置: `首页推荐`
- 产品状态: `立即发布`
- 排序权重: 自动填充
- 点击: 创建产品

**预期结果:**
- ✅ 显示成功提示: "产品创建成功! ID: RD-001"
- ✅ 产品列表中显示新产品
- ✅ 产品型号显示为 `RD-001`

### 3. 测试前端网站

#### 测试产品列表

1. 访问: http://localhost:8080/products.html
2. 检查:
   - ✅ 产品卡片正常显示
   - ✅ 产品信息正确(名称、价格、特性)
   - ✅ 点击卡片跳转到详情页

#### 测试产品详情页

1. 访问: http://localhost:8080/products/RD-001/产品详情.html
2. 检查:
   - ✅ 页面正常加载
   - ✅ 图片正常显示
   - ✅ 样式正常应用
   - ✅ 脚本正常执行

#### 测试首页推荐

1. 访问: http://localhost:8080/index.html
2. 滚动到: 核心产品系列
3. 检查:
   - ✅ 推广位置为 `homepage_recommend` 的产品显示
   - ✅ 产品信息正确
   - ✅ 点击查看详情跳转正确

#### 测试分类展示

1. 访问: http://localhost:8080/index.html
2. 滚动到: 产品分类
3. 检查:
   - ✅ 分类卡片正常显示
   - ✅ 产品数量正确
   - ✅ 点击查看更多筛选产品

### 4. 测试分类切换

1. 在产品列表页点击分类筛选按钮
2. 检查:
   - ✅ 产品列表更新为该分类的产品
   - ✅ URL参数更新 `?categoryId=1`
   - ✅ 分类按钮状态更新

### 5. 测试产品修改

#### 修改产品分类

1. 在后台管理系统中编辑产品
2. 修改分类为另一个分类
3. 保存
4. 检查前端:
   - ✅ 产品在新分类下显示
   - ✅ 产品不在旧分类下显示

#### 更新详情页文件

1. 编辑产品
2. 进入第二步
3. 重新上传文件夹
4. 保存
5. 检查:
   - ✅ 旧文件被替换
   - ✅ 新文件正常访问

### 6. 测试产品删除

1. 在产品列表中删除产品
2. 检查:
   - ✅ 产品从列表中移除
   - ✅ 文件夹 `public/products/RD-001` 被删除
   - ✅ 前端不再显示该产品

---

## 🐛 已知问题

### 需要手动集成的部分

1. **前端网站需要引入加载器脚本**
   
   在 `web Site/web PC/index.html` 中添加:
   ```html
   <script src="js/product-loader.js"></script>
   <script src="js/category-loader.js"></script>
   ```

2. **产品列表页需要容器元素**
   
   确保HTML中有:
   ```html
   <div id="products-grid"></div>
   <div class="categories-container"></div>
   ```

3. **首页推荐区域需要ID**
   
   确保HTML中有:
   ```html
   <section id="core-products">
     <div class="products-showcase"></div>
   </section>
   ```

---

## 📊 测试结果记录

### 后端测试

| 测试项 | 状态 | 备注 |
|--------|------|------|
| 产品ID自动生成 | ⏳ 待测试 | |
| 文件夹自动重命名 | ⏳ 待测试 | |
| 产品创建API | ⏳ 待测试 | |
| 文件上传API | ⏳ 待测试 | |

### 前端测试

| 测试项 | 状态 | 备注 |
|--------|------|------|
| 产品向导组件 | ⏳ 待测试 | |
| 产品列表加载 | ⏳ 待测试 | |
| 产品详情页访问 | ⏳ 待测试 | |
| 首页推荐显示 | ⏳ 待测试 | |
| 分类筛选功能 | ⏳ 待测试 | |

### 集成测试

| 测试项 | 状态 | 备注 |
|--------|------|------|
| 完整创建流程 | ⏳ 待测试 | |
| 分类切换同步 | ⏳ 待测试 | |
| 产品修改同步 | ⏳ 待测试 | |
| 产品删除清理 | ⏳ 待测试 | |

---

## 🚀 下一步行动

### 立即测试

1. 重启后端服务
2. 重启后台管理系统
3. 创建一个测试产品
4. 验证所有功能

### 集成到前端网站

1. 在 `index.html` 中引入加载器脚本
2. 在 `products.html` 中引入加载器脚本
3. 添加必要的容器元素
4. 测试动态加载功能

### 优化体验

1. 添加加载动画
2. 添加错误提示
3. 优化图片加载
4. 添加搜索功能

---

## 📝 测试清单

完成测试后请勾选:

- [ ] 后端服务正常启动
- [ ] 产品ID自动生成功能正常
- [ ] 文件夹自动重命名功能正常
- [ ] 产品创建向导正常工作
- [ ] 文件夹上传校验正常
- [ ] 产品在后台列表中显示
- [ ] 产品在前端列表中显示
- [ ] 产品详情页可以访问
- [ ] 首页推荐区域显示正常
- [ ] 分类筛选功能正常
- [ ] 产品修改同步正常
- [ ] 产品删除清理正常

---

**测试日期**: ___________  
**测试人员**: ___________  
**测试结果**: ⏳ 待测试 / ✅ 通过 / ❌ 失败

---

**祝测试顺利!** 🎉
